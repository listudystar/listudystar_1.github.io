
# KMeans-啤酒聚类

### >> 1. 加载数据


```python
import pandas as pd
beer = pd.read_csv('data.txt', sep=' ')
beer
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>calories</th>
      <th>sodium</th>
      <th>alcohol</th>
      <th>cost</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Budweiser</td>
      <td>144</td>
      <td>15</td>
      <td>4.7</td>
      <td>0.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Schlitz</td>
      <td>151</td>
      <td>19</td>
      <td>4.9</td>
      <td>0.43</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lowenbrau</td>
      <td>157</td>
      <td>15</td>
      <td>0.9</td>
      <td>0.48</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kronenbourg</td>
      <td>170</td>
      <td>7</td>
      <td>5.2</td>
      <td>0.73</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Heineken</td>
      <td>152</td>
      <td>11</td>
      <td>5.0</td>
      <td>0.77</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Old_Milwaukee</td>
      <td>145</td>
      <td>23</td>
      <td>4.6</td>
      <td>0.28</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Augsberger</td>
      <td>175</td>
      <td>24</td>
      <td>5.5</td>
      <td>0.40</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Srohs_Bohemian_Style</td>
      <td>149</td>
      <td>27</td>
      <td>4.7</td>
      <td>0.42</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Miller_Lite</td>
      <td>99</td>
      <td>10</td>
      <td>4.3</td>
      <td>0.43</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Budweiser_Light</td>
      <td>113</td>
      <td>8</td>
      <td>3.7</td>
      <td>0.40</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Coors</td>
      <td>140</td>
      <td>18</td>
      <td>4.6</td>
      <td>0.44</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Coors_Light</td>
      <td>102</td>
      <td>15</td>
      <td>4.1</td>
      <td>0.46</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Michelob_Light</td>
      <td>135</td>
      <td>11</td>
      <td>4.2</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Becks</td>
      <td>150</td>
      <td>19</td>
      <td>4.7</td>
      <td>0.76</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Kirin</td>
      <td>149</td>
      <td>6</td>
      <td>5.0</td>
      <td>0.79</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Pabst_Extra_Light</td>
      <td>68</td>
      <td>15</td>
      <td>2.3</td>
      <td>0.38</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Hamms</td>
      <td>139</td>
      <td>19</td>
      <td>4.4</td>
      <td>0.43</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Heilemans_Old_Style</td>
      <td>144</td>
      <td>24</td>
      <td>4.9</td>
      <td>0.43</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Olympia_Goled_Light</td>
      <td>72</td>
      <td>6</td>
      <td>2.9</td>
      <td>0.46</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Schlitz_Light</td>
      <td>97</td>
      <td>7</td>
      <td>4.2</td>
      <td>0.47</td>
    </tr>
  </tbody>
</table>
</div>




```python
X = beer.drop(['name'],axis = 1) # 去掉name列
```

### >> 2. KMeans聚类


```python
from sklearn.cluster import KMeans

km = KMeans(n_clusters=3).fit(X) # 聚类数为3
km2 = KMeans(n_clusters=2).fit(X) # 聚类数为2
```

### >> 3. 聚类结果（未标准化）


```python
km.labels_
```




    array([1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 2, 1, 1, 1, 0, 1, 1, 0, 2])




```python
km2.labels_
```




    array([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1])




```python
beer['KM_3'] = km.labels_
beer['KM_2'] = km2.labels_
```


```python
beer
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>calories</th>
      <th>sodium</th>
      <th>alcohol</th>
      <th>cost</th>
      <th>KM_3</th>
      <th>KM_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Budweiser</td>
      <td>144</td>
      <td>15</td>
      <td>4.7</td>
      <td>0.43</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Schlitz</td>
      <td>151</td>
      <td>19</td>
      <td>4.9</td>
      <td>0.43</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lowenbrau</td>
      <td>157</td>
      <td>15</td>
      <td>0.9</td>
      <td>0.48</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kronenbourg</td>
      <td>170</td>
      <td>7</td>
      <td>5.2</td>
      <td>0.73</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Heineken</td>
      <td>152</td>
      <td>11</td>
      <td>5.0</td>
      <td>0.77</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Old_Milwaukee</td>
      <td>145</td>
      <td>23</td>
      <td>4.6</td>
      <td>0.28</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Augsberger</td>
      <td>175</td>
      <td>24</td>
      <td>5.5</td>
      <td>0.40</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Srohs_Bohemian_Style</td>
      <td>149</td>
      <td>27</td>
      <td>4.7</td>
      <td>0.42</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Miller_Lite</td>
      <td>99</td>
      <td>10</td>
      <td>4.3</td>
      <td>0.43</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Budweiser_Light</td>
      <td>113</td>
      <td>8</td>
      <td>3.7</td>
      <td>0.40</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Coors</td>
      <td>140</td>
      <td>18</td>
      <td>4.6</td>
      <td>0.44</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Coors_Light</td>
      <td>102</td>
      <td>15</td>
      <td>4.1</td>
      <td>0.46</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Michelob_Light</td>
      <td>135</td>
      <td>11</td>
      <td>4.2</td>
      <td>0.50</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Becks</td>
      <td>150</td>
      <td>19</td>
      <td>4.7</td>
      <td>0.76</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Kirin</td>
      <td>149</td>
      <td>6</td>
      <td>5.0</td>
      <td>0.79</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Pabst_Extra_Light</td>
      <td>68</td>
      <td>15</td>
      <td>2.3</td>
      <td>0.38</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Hamms</td>
      <td>139</td>
      <td>19</td>
      <td>4.4</td>
      <td>0.43</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Heilemans_Old_Style</td>
      <td>144</td>
      <td>24</td>
      <td>4.9</td>
      <td>0.43</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Olympia_Goled_Light</td>
      <td>72</td>
      <td>6</td>
      <td>2.9</td>
      <td>0.46</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Schlitz_Light</td>
      <td>97</td>
      <td>7</td>
      <td>4.2</td>
      <td>0.47</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



### >> 3. 聚类结果（标准化）

#### 标准化是消除数据之间的差异性，在聚类任务前，都应该做这项工作；


```python
from sklearn.preprocessing import StandardScaler # 标准化
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)
X_scaled
```




    array([[ 0.38791334,  0.00779468,  0.43380786, -0.45682969],
           [ 0.6250656 ,  0.63136906,  0.62241997, -0.45682969],
           [ 0.82833896,  0.00779468, -3.14982226, -0.10269815],
           [ 1.26876459, -1.23935408,  0.90533814,  1.66795955],
           [ 0.65894449, -0.6157797 ,  0.71672602,  1.95126478],
           [ 0.42179223,  1.25494344,  0.3395018 , -1.5192243 ],
           [ 1.43815906,  1.41083704,  1.1882563 , -0.66930861],
           [ 0.55730781,  1.87851782,  0.43380786, -0.52765599],
           [-1.1366369 , -0.7716733 ,  0.05658363, -0.45682969],
           [-0.66233238, -1.08346049, -0.5092527 , -0.66930861],
           [ 0.25239776,  0.47547547,  0.3395018 , -0.38600338],
           [-1.03500022,  0.00779468, -0.13202848, -0.24435076],
           [ 0.08300329, -0.6157797 , -0.03772242,  0.03895447],
           [ 0.59118671,  0.63136906,  0.43380786,  1.88043848],
           [ 0.55730781, -1.39524768,  0.71672602,  2.0929174 ],
           [-2.18688263,  0.00779468, -1.82953748, -0.81096123],
           [ 0.21851887,  0.63136906,  0.15088969, -0.45682969],
           [ 0.38791334,  1.41083704,  0.62241997, -0.45682969],
           [-2.05136705, -1.39524768, -1.26370115, -0.24435076],
           [-1.20439469, -1.23935408, -0.03772242, -0.17352445]])




```python
km = KMeans(n_clusters=3).fit(X_scaled)
```


```python
beer["scaled_cluster"] = km.labels_
beer
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>calories</th>
      <th>sodium</th>
      <th>alcohol</th>
      <th>cost</th>
      <th>KM_3</th>
      <th>KM_2</th>
      <th>scaled_cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Budweiser</td>
      <td>144</td>
      <td>15</td>
      <td>4.7</td>
      <td>0.43</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Schlitz</td>
      <td>151</td>
      <td>19</td>
      <td>4.9</td>
      <td>0.43</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lowenbrau</td>
      <td>157</td>
      <td>15</td>
      <td>0.9</td>
      <td>0.48</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kronenbourg</td>
      <td>170</td>
      <td>7</td>
      <td>5.2</td>
      <td>0.73</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Heineken</td>
      <td>152</td>
      <td>11</td>
      <td>5.0</td>
      <td>0.77</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Old_Milwaukee</td>
      <td>145</td>
      <td>23</td>
      <td>4.6</td>
      <td>0.28</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Augsberger</td>
      <td>175</td>
      <td>24</td>
      <td>5.5</td>
      <td>0.40</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Srohs_Bohemian_Style</td>
      <td>149</td>
      <td>27</td>
      <td>4.7</td>
      <td>0.42</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Miller_Lite</td>
      <td>99</td>
      <td>10</td>
      <td>4.3</td>
      <td>0.43</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Budweiser_Light</td>
      <td>113</td>
      <td>8</td>
      <td>3.7</td>
      <td>0.40</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Coors</td>
      <td>140</td>
      <td>18</td>
      <td>4.6</td>
      <td>0.44</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Coors_Light</td>
      <td>102</td>
      <td>15</td>
      <td>4.1</td>
      <td>0.46</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Michelob_Light</td>
      <td>135</td>
      <td>11</td>
      <td>4.2</td>
      <td>0.50</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Becks</td>
      <td>150</td>
      <td>19</td>
      <td>4.7</td>
      <td>0.76</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Kirin</td>
      <td>149</td>
      <td>6</td>
      <td>5.0</td>
      <td>0.79</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Pabst_Extra_Light</td>
      <td>68</td>
      <td>15</td>
      <td>2.3</td>
      <td>0.38</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Hamms</td>
      <td>139</td>
      <td>19</td>
      <td>4.4</td>
      <td>0.43</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Heilemans_Old_Style</td>
      <td>144</td>
      <td>24</td>
      <td>4.9</td>
      <td>0.43</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Olympia_Goled_Light</td>
      <td>72</td>
      <td>6</td>
      <td>2.9</td>
      <td>0.46</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Schlitz_Light</td>
      <td>97</td>
      <td>7</td>
      <td>4.2</td>
      <td>0.47</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>



### >> 4. 分类结果（图示）


```python
%matplotlib inline
import matplotlib.pyplot as plt
import numpy as np
colors  = np.array(['red','green','blue','yellow'])
```


```python
plt.scatter(beer["calories"], beer["alcohol"],c=colors[beer["KM_3"]])

plt.xlabel("Calories")
plt.ylabel("Alcohol")
```




    Text(0, 0.5, 'Alcohol')




![image](https://github.com/listudystar/listudystar.github.io/raw/master/_posts/20190731_1.png)



```python
plt.scatter(beer["calories"], beer["alcohol"],c=colors[beer["KM_2"]])

plt.xlabel("Calories")
plt.ylabel("Alcohol")
```




    Text(0, 0.5, 'Alcohol')




![image](https://github.com/listudystar/listudystar.github.io/raw/master/_posts/20190731_2.png)



```python
plt.scatter(beer["calories"], beer["alcohol"],c=colors[beer["scaled_cluster"]])

plt.xlabel("Calories")
plt.ylabel("Alcohol")
```




    Text(0, 0.5, 'Alcohol')




![image](https://github.com/listudystar/listudystar.github.io/raw/master/_posts/20190731_3.png)


##### 标准化之后的结果没有未标准化的结果好，因此进不进行标准化处理，需要试验确定；

### >> 5. 聚类评估：轮廓系数


![image](https://github.com/listudystar/listudystar.github.io/raw/master/_posts/20190731_5.png)

- 计算样本i到同簇其他样本的平均距离ai。ai 越小，说明样本i越应该被聚类到该簇。将ai 称为样本i的簇内不相似度。
- 计算样本i到其他某簇Cj 的所有样本的平均距离bij，称为样本i与簇Cj 的不相似度。定义为样本i的簇间不相似度：bi =min{bi1, bi2, ..., bik}

##### Si接近于1，则说明样本i聚类合理；
##### Si接近于-1，则说明样本i应该分类到另外簇；
##### Si接近于0，则说明样本在两个族的边界上；


```python
from sklearn import metrics

# 求解不同k值的轮廓系数
scores = []
for k in range(2,20):
    labels = KMeans(n_clusters=k).fit(X).labels_
    score = metrics.silhouette_score(X, labels)
    scores.append(score)
scores

```




    [0.6917656034079486,
     0.6731775046455796,
     0.5857040721127795,
     0.4225487335172022,
     0.4559182167013378,
     0.43776116697963136,
     0.38946337473126,
     0.3658612182712316,
     0.4081599013899603,
     0.32472080133848924,
     0.3459775237127248,
     0.31221439248428434,
     0.30707782144770296,
     0.31834561839139497,
     0.2849514001174898,
     0.23498077333071996,
     0.1588091017496281,
     0.08423051380151177]




```python
# 作图
plt.plot(list(range(2,20)), scores)
plt.xlabel("Number of Clusters Initialized")
plt.ylabel("Sihouette Score")
```




    Text(0, 0.5, 'Sihouette Score')




![image](https://github.com/listudystar/listudystar.github.io/raw/master/_posts/20190731_4.png)


##### 根据轮廓系数发现，K=2的聚类结果最好；
